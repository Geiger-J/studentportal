<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Request - Bromsgrove Student Portal</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Header -->
    <div th:replace="fragments/header :: header"></div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="form-container">
                <h1>Create Tutoring Request</h1>
                <p class="form-subtitle">Submit a request to offer or seek tutoring</p>

                <!-- Error Messages -->
                <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

                <!-- Request Form -->
                <form action="/requests" method="post" class="form">
                    
                    <!-- Request Type -->
                    <div class="form-group">
                        <label for="type" class="form-label">Request Type *</label>
                        <select id="type" name="type" class="form-control" required>
                            <option value="">Select request type</option>
                            <option th:each="requestType : ${requestTypes}" 
                                    th:value="${requestType.name()}" 
                                    th:text="${requestType.displayName}">Offering Tutoring</option>
                        </select>
                        <small>Choose whether you want to offer tutoring or seek help</small>
                    </div>

                    <!-- Subject -->
                    <div class="form-group">
                        <label for="subjectId" class="form-label">Subject *</label>
                        <select id="subjectId" name="subjectId" class="form-select" required>
                            <option value="">Select subject</option>
                            <option th:each="subject : ${subjects}" 
                                    th:value="${subject.id}" 
                                    th:text="${subject.displayName}">Mathematics</option>
                        </select>
                        <small class="form-help">Select the subject for this tutoring request</small>
                    </div>

                    <!-- Timeslots -->
                    <div class="form-group">
                        <label class="form-label">Available Timeslots *</label>
                        <p class="section-description">Select when you're available for this tutoring session:</p>
                        <table class="timeslot-table">
                            <thead>
                                <tr>
                                    <th>Period</th>
                                    <th>Monday</th>
                                    <th>Tuesday</th>
                                    <th>Wednesday</th>
                                    <th>Thursday</th>
                                    <th>Friday</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="period-label">P1 (09:00-09:50)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P1)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P1)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P1" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P1)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P1)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P1)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P1)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P1)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P1" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P1)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P1)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P1)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P1)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P1)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P1" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P1)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P1)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P1)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P1)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P1)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P1" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P1)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P1)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P1)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P1)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P1)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P1" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P1)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P1)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P1)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="period-label">P2 (09:55-10:45)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P2)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P2)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P2" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P2)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P2)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P2)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P2)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P2)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P2" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P2)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P2)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P2)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P2)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P2)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P2" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P2)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P2)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P2)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P2)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P2)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P2" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P2)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P2)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P2)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P2)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P2)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P2" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P2)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P2)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P2)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="period-label">P3 (11:05-11:55)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P3)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P3)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P3" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P3)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P3)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P3)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P3)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P3)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P3" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P3)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P3)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P3)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P3)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P3)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P3" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P3)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P3)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P3)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P3)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P3)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P3" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P3)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P3)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P3)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P3)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P3)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P3" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P3)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P3)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P3)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="period-label">P4 (12:00-12:50)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P4)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P4)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P4" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P4)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P4)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P4)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P4)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P4)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P4" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P4)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P4)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P4)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P4)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P4)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P4" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P4)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P4)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P4)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P4)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P4)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P4" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P4)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P4)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P4)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P4)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P4)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P4" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P4)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P4)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P4)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="period-label">P5 (13:45-14:35)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P5)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P5)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P5" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P5)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P5)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P5)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P5)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P5)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P5" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P5)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P5)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P5)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P5)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P5)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P5" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P5)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P5)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P5)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P5)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P5)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P5" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P5)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P5)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P5)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P5)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P5)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P5" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P5)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P5)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P5)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="period-label">P6 (14:40-15:30)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P6)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P6)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P6" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P6)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P6)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P6)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P6)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P6)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P6" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P6)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P6)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P6)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P6)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P6)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P6" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P6)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P6)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P6)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P6)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P6)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P6" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P6)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P6)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P6)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P6)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P6)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P6" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P6)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P6)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P6)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="period-label">P7 (16:00-17:15)</td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P7)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P7)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="MON_P7" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P7)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P7)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).MON_P7)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P7)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P7)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="TUE_P7" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P7)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P7)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).TUE_P7)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P7)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P7)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="WED_P7" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P7)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P7)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).WED_P7)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P7)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P7)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="THU_P7" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P7)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P7)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).THU_P7)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                    <td class="timeslot-cell" 
                                        th:classappend="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P7)} ? '' : 'disabled'"
                                        th:onclick="${userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P7)} ? 'toggleTimeslot(this)' : ''">
                                        <input type="checkbox" name="timeslots" value="FRI_P7" 
                                               th:disabled="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P7)}"
                                               th:title="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P7)} ? 'Not in your availability. Edit profile to enable.' : ''">
                                        <span th:if="${!userAvailability.contains(T(com.example.studentportal.model.Timeslot).FRI_P7)}" class="tooltip-text">Not in your availability. Edit profile to enable.</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <small class="form-help">Select at least one time slot when you're available. Grayed out slots are not in your profile availability.</small>
                    </div>

                    <!-- Information Box -->
                    <div class="info-box">
                        <h3>Important Information</h3>
                        <ul>
                            <li>Your request will be scheduled for the upcoming Monday</li>
                            <li>You can only have one active request per subject and type</li>
                            <li>Requests can be cancelled while in "Pending" status</li>
                            <li>Matching with other students will happen automatically</li>
                        </ul>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-large">Create Request</button>
                        <a href="/dashboard" class="btn btn-secondary">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <div th:replace="fragments/footer :: footer"></div>

    <script>
        // Timeslot cell toggle functionality (same as profile page)
        function toggleTimeslot(cell) {
            const checkbox = cell.querySelector('input[type="checkbox"]');
            if (checkbox && !checkbox.disabled) {
                checkbox.checked = !checkbox.checked;
                cell.classList.toggle('selected', checkbox.checked);
                cell.setAttribute('aria-pressed', checkbox.checked.toString());
            }
        }

        // Initialize selected states on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.timeslot-cell').forEach(cell => {
                const checkbox = cell.querySelector('input[type="checkbox"]');
                if (checkbox && checkbox.checked) {
                    cell.classList.add('selected');
                }
            });
        });

        // Form validation
        document.querySelector('form').addEventListener('submit', function(e) {
            const timeslots = document.querySelectorAll('input[name="timeslots"]:checked');
            if (timeslots.length === 0) {
                e.preventDefault();
                alert('Please select at least one timeslot');
                return false;
            }
        });
    </script>
</body>
</html>